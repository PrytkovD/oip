# Журнал изменений

## Задание 1 &mdash; 20.03.2025

### Добавлено

- Базовые классы:
    - `repository.Repository`
    - `serialization.Serializer`
    - `serialization.Deserializer`
- Класс веб-страницы `page.Page`
    - А так же реализации базовых классов для работы с ним
- Класс элемента индекса `index.IndexEntry`
    - А так же реализации базовых классов для работы с ним
- Класс для скачивания веб-страниц `downloader.PageDownloader`
- Класс ползуна `crawler.Crawler`
- Логика для скачивания и сохранения 100 страниц

## Задание 2 &mdash; 03.04.2025

В процессе выполнения этого задания был произведен значительный рефакторинг

### Добавлено

- Класс `Token`
- Класс `Lemma`
- Классы-обертки `PageTokens` и `PageLemmas`
- Сопутствующие базовые классы
- Класс `Tokenizer`
- Вспомогательные классы `TokenFilter`, `TokenNormalizer`, `TextExtractor`
- Класс `Lemmatizer`
- Реализации `Repository`: `SingleFileRepository` для сохранения всех объектов в одном файле и `MultiFileRepository` для
  сохранения каждого обхекта в своём файле

### Изменено

- Проект разбит на два базовых пакета `base` и `impl` для моделей и интерфейсов и их реализаций, соответсвенно
- `PageRepository` теперь сам отвечает за файл `index.txt` через делегирование к `IndexEntryRepository`
- Много мелких изменений в базовых классах

## Задание 2 &mdash; правка 04.04.2025

### Добавлено

- Методы `__eq__`, `__lt__` и `__hash__` для моделей

### Изменено

- `Tokenizer`, `Lemmatizer` и репозитории теперь убирают дубликаты и возвращают отсортированные списки

## Задание 3 &mdash; 09.04.2025

### Добавлено

- Класс `PageIndex` &mdash; удобная обёртка поверх `PageIndexEntryRepository`
- Класс `PartitionedFileRepository`, хранящий строки в нескольких файлах. Файл партиции определяется по хэшу ключа
  строки
- Класс `TokenIndexEntry` для хранения строк инвертированного индекса токенов
- Класс `TokenIndex` &mdash; удобная обёртка поверх `TokenIndexEntryRepository`
- Класс `Query` &mdash; поисковой запрос
- Класс `QueryToken` &mdash; токен поискового запроса
- Класс `QueryTokenizer` для разбиения поискового запроса на токены
- Класс `QueryNode` &mdash; узел АСД поискового запроса
- Класс `QueryParser` для построения АСД поискового запроса по списку токенов
- Класс `QueryPlanNode` &mdash; узел плана выполнения запроса
- Класс `QueryPlanner` для построения плана выполнения запроса по АСД
- Класс `QueryPlanExecutor` для выполнения поисковых запросов
- Вспомогательные классы `QueryNodeVisitor` и `QueryPlanNodeVisitor` для работы с АСД и деревом плана запроса
- Класс `SimplifyingQueryNodeVisitor` для упрощения поискового запроса по правилам двоичной логики
- REPL-консоль

### Изменено

- Класс `IndexEntry` переименован в `PageIndexEntry`
    - Сопутствующие классы также получили префикс `PageIndexEntry`
- Ключ `PageIndexEntry` сменен с `page_file_path` на `page_url`
- `PageRepository` теперь использует `PageIndex` вместо `PageIndexEntryRepository` напрямую

## Задание 4 &mdash; 01.05.2025

### БД-Бэкенд

В ходе выполнения задачи мы пришли к выводу, что слишком много времени тратим на перевод данных в нужный для вычисления
чего-нибудь формат. Поэтому было решено реализовать универсальный движок по типу реляционной базы данных, который бы
позволил выполнять рутинные операции легко (а заодно дал бы нам индексы бесплатно).

Структура примерно следующая:

- `Expression` &mdash; любое выражение, которое можно вписать в SELECT-запрос
- `Column` &mdash; столбец, специализация `Expression`, привязанная к таблице
- `ColumnSet` &mdash; набор столбцов (на деле выражений), поддерживающий операции проверки вхождения столбца и выборки
  подмножества стобцов
- `Record` &mdash; строка, кортеж, запись &mdash; хранит данные по столбцам
- `RecordSet` &mdash; набор строк, позволяет (лениво) итерироваться по ним, поддерживает стандартные операторы вроде
  JOIN, ORDER BY, GROUP BY, WHERE и т.д. через специальные реализации
- `Table` &mdash; специализированный `RecordSet`, коллекция страниц
- `Page` &mdash; специализированный `RecordSet`, поддерживающий чтение и запись в файл
- `FilePageStorage` &mdash; вспомогательный класс, выступающий в качестве LRU-кэша страниц таблицы, держит недавно
  задействованные страницы в памяти, читает новые по необходимости и пишет старые за ненадобностью

### Добавлено

- Новые реализации репозиториев на базе нового БД-бэкенда (`XxxDatabaseRepository`)
- Новые индексы на базе нового БД-бэкенда
- Вычисление TF-IDF с помощью `Page(Tokens|Lemmas)TfIdfsDatabaseRepository`